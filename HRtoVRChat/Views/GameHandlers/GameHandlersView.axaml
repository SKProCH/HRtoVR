<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:HRtoVRChat.ViewModels.GameHandlers"
             xmlns:controls="using:HRtoVRChat.Controls"
             xmlns:listeners="using:HRtoVRChat.Views.Listeners"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="HRtoVRChat.Views.GameHandlers.GameHandlersView"
             x:DataType="vm:GameHandlersViewModel">
    <Grid>
        <ScrollViewer>
            <ItemsControl ItemsSource="{Binding Handlers}" Padding="10">
                <ItemsControl.Styles>
                    <Style Selector="ItemsControl > ContentPresenter">
                        <Setter Property="Padding" Value="0,0,0,10" />
                    </Style>
                    <Style Selector="ItemsControl > ContentPresenter:last-child">
                        <Setter Property="Padding" Value="0" />
                    </Style>
                </ItemsControl.Styles>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Expander HorizontalAlignment="Stretch">
                            <Expander.Header>
                                <Grid ColumnDefinitions="*, Auto">
                                    <ToggleSwitch IsChecked="{Binding IsEnabled}"
                                                  OnContent="{Binding Name}"
                                                  OffContent="{Binding Name}"
                                                  Margin="0,0,10,0"
                                                  FontWeight="Bold"/>

                                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" IsVisible="{Binding IsEnabled}">
                                        <Border Margin="0,0,10,0"
                                                Padding="5,2"
                                                CornerRadius="3"
                                                Background="{Binding IsRunning, Converter={StaticResource BoolToRunningBackgroundConverter}}">
                                            <TextBlock Text="RUNNING"
                                                       FontSize="10"
                                                       Foreground="White"
                                                       FontWeight="Bold"/>
                                        </Border>

                                        <controls:ConnectionIndicator IsConnected="{Binding IsConnected}"
                                                                      HeartRate="{Binding HeartRate}" />
                                    </StackPanel>
                                </Grid>
                            </Expander.Header>
                            <listeners:ListenerSettingsView DataContext="{Binding}" Margin="5" />
                        </Expander>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>
